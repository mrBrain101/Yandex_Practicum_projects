<div style='width: 700px; text-align: justify'>

## Задача.
  - Разработка алгоритма мэтчинга товаров, с максимизацией `accuracy@5`.

## Результат работы.
  - Максимальное значение целевой метрики `accuracy@5` ~70.8 достигнуто с использованием индекса `IVF1600,Flat` модели `FAISS` и параметров:
    - данные смасштабированны с помощью `RobustScaler`;
    - удалены признаки с ненормальным распределением;
    - размерность дополнительно снижена встроенным методом `PCA` до 55 признаков;
    - метрика: косинусное сходство;
    - кол-во кластеров: 1600;
    - класт., рассматриваемых при поиске (`nprobe`): 200.

## Модели, использовавшиеся в тестах.
- `KMeans` с инициализацией `kmeans++`;
- `MiniBatchKMeans` с инициализацией `kmeans++`;
- `FAISS`;
- `ANNOY`.

## Данные.
- Размер датасетов:
  - `df_base`: 2918139 X 72 с идентификаторами объектов в индексе;
  - `df_train`: 100000 X 73, в т.ч. признак ответов, и с идентификаторами объектов в индексе;
  - `df_val`: 100000 X 72 с идентификаторами объектов в индексе;
  - `df_val_answers`: 100000 X 1 - признак ответов с идентификаторами объектов в индексе.
- Распределение признаков.
  - Признаки 6, 21, 25, 33, 44, 59, 65, 70 имеют ненормальное распределение. Остальные признаки имеют распределения, приближенные к нормальному. <br>
  Из-за невозможности идентификации признаков и неэффективности преобразований распределений признаков с точки зрения целевой метрики, признаки с ненормальным распределением были удалены.
- Выбросы / аномалии.
  - Почти во всех признаках среднее близко к медиане и присутствует минимальный процент выбросов. Удаление и замена выбросов средним не оказались эффективными.
- Признаки 33 и 44 дискретны, возможно категориальны, т.к. имеют менее 1% и 2% уникальных значений соответственно. Была проведена тестовая кластеризация по уникальным значениям признака `33`, которая не оказалась эффективной.
- Корреляция признаков / мультиколлинеарность.
  - Корреляция признаков не обнаружена.

## Рекомендации / возможные направления улучшения точности мэтчинга.
  - Проведение более развёрнутого анализа кластеров / признаков, в т.ч., покластерного.
  - Оптимизация реализации связки "простых" алгоритмов `KMeans` + `NearestNeigbors`.
  - Добавление ранжирования с использованием успешного индекса `FAISS` для всех признаков и оценкой кандидатов алгоритмом `CatBoost`.
</div>
